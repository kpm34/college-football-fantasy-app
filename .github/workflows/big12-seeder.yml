name: Big 12 Data Seeder

on:
  schedule:
    # Run once at script start (manual trigger for now)
    - cron: '0 0 1 8 *'  # August 1st at midnight UTC
  workflow_dispatch: # Allow manual triggers
  push:
    paths:
      - 'src/scripts/create-kash-database.js'
      - 'src/scripts/add-bigten-teams-data.js'

jobs:
  seed-big12-data:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: Install dependencies
      run: |
        npm install node-appwrite
        
    - name: Run Big 12 data seeder
      # ‚ö†Ô∏è SECURITY WARNING: API KEYS ARE EXPOSED IN THIS FILE!
      # TODO: Move these to GitHub Secrets before pushing to production
      # Go to: Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret
      # Add: CFBD_API_KEY, APPWRITE_ENDPOINT, APPWRITE_PROJECT_ID, APPWRITE_API_KEY
      env:
        CFBD_API_KEY: YKG446gILGiO5q+OIgOClYsBO9ztbPfGyBBrz40V1c3LBshdTIbFjHzFcu6iOhGz  # ‚ö†Ô∏è EXPOSED - MOVE TO SECRETS
        ODDS_API_KEY: ${{ secrets.ODDS_API_KEY }}
        ROTOWIRE_API_KEY: ${{ secrets.ROTOWIRE_API_KEY }}
        APPWRITE_ENDPOINT: https://nyc.cloud.appwrite.io/v1  # ‚ö†Ô∏è EXPOSED - MOVE TO SECRETS
        APPWRITE_PROJECT_ID: college-football-fantasy-app  # ‚ö†Ô∏è EXPOSED - MOVE TO SECRETS
        APPWRITE_API_KEY: standard_c63261941dc9ffcd31b7dbd5ba6706c0335d4543d78630ebe88a0e6899b770f334e22d032aa0e709c24ea84e8c907d314881a1408beb6f61db97d94e614333e004e353d078791d02f26581741c9ed454fc6d9bb2d2414dfed0d8b68c5b957f3fc2fad22ff87ceadad110c9bdb34a98ee1071c46952ab142d7580a83e3db8186b  # ‚ö†Ô∏è EXPOSED - MOVE TO SECRETS
      run: |
        echo "üèà Setting up Big 12 data collection..."
        echo "üìä This workflow is ready for Big 12 team data when available"
        echo "üîß Current focus: Database setup and data structure"
        
        # Run database setup if needed
        # node src/scripts/create-kash-database.js
        
        # TODO: Add Big 12 team data collection when available
        # node src/scripts/add-big12-teams-data.js
        
    - name: Notify on success
      if: success()
      run: |
        echo "‚úÖ Big 12 data seeding workflow ready at $(date)"
        echo "üìä Workflow prepared for Big 12 teams and projection data"
        echo "üîß Database structure verified and ready"
        
    - name: Notify on failure
      if: failure()
      run: |
        echo "‚ùå Big 12 data seeding workflow failed at $(date)"
        echo "üîç Check logs for configuration or API issues" 